<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Test</title>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css/slick.css">
	

	<link rel="stylesheet" type="text/css" href="css/style.css">

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript" src="js/slick.js"></script>
</head>
<body>

	<div class="theQuestion">


		<div class="questItem bg1">
					<div class="row h-100 justify-content-center align-items-center">
						<div class="col-md-12">
							<div class="container" id="summary">
								<h2 class="verdict"></h2>
								<div class="sumConent"></div>
							</div>
						</div>
					</div>
				</div>
		
	</div>
	

	<script>
		//https://tympanus.net/Tutorials/CSSButtonsPseudoElements/index2.html#
		//https://keyboard-keys-demo-avsboucyiw.now.sh/
		function shuffleArray(array) {
			console.log(array.length)
		    for (var i = array.length - 1; i > 0; i--) {
		        	for (var i = array.length - 1; i > 0; i--) {
			        	var j = Math.floor(Math.random() * (i + 1));
			        	var temp = array[i];
			        	array[i] = array[j];
			        	array[j] = temp;
			    	}
		    }
		}


		var questions = [
			{id:321,q:'a',o:['1','2','3','4'],a:'3'},
			{id:322,q:'b',o:['2','3','5','8'],a:'5'},
			{id:323,q:'c',o:['3','2','4','9'],a:'4'},
			{id:324,q:'d',o:['4','9','5','7'],a:'9'},
			{id:325,q:'e',o:['5','6','7','8'],a:'8'},
			{id:326,q:'f',o:['6','8','9','5'],a:'5'},
			{id:327,q:'g',o:['7','9','6','4'],a:'4'},
			{id:328,q:'h',o:['8','4','1','3'],a:'1'},
			{id:329,q:'i',o:['9','3','2','2'],a:'2'},
			{id:330,q:'j',o:['1','2','6','3'],a:'3'},
			{id:331,q:'k',o:['2','3','7','4'],a:'3'},
		]
		var numSelQuest = 5;
		var selQuest = [];
		var userAns = [];
		var checkAns = [];
		var wrongAns = [];
		var shuffles = questions.sort(() => Math.random() - 0.5);

		shuffles.forEach(function(value, index){
			if (index < 5) {
				selQuest.push(value)
			}
		});



		//console.log(selQuest);
		var selQuestLen = selQuest.length - 1;
		selQuest.forEach(function(i, index){
			var rawoptions = i['o'].sort(() => Math.random() - 0.5);

			var option = "";
			var button = "";
			rawoptions.forEach(function(item,idx){
				var letter = ["A","B","C","D"];
				option += `<div class="col-md-6 btnOption" data-qid='${i['id']}' data-val='${item}' data-letter='${letter[idx]}'>
					<div class="card p-3 mb-3">
						${letter[idx]}. ${item}
					</div>
				</div>`;
			});

			var operationBtn = '';

			if (index == 0) {
				
				operationBtn = `<div class="btnNextCon d-flex">
									<button class="mybtn btnPrev btnRip">back</button>
									<button class="mybtn btnDone btnRip ml-auto">finish</button>
								</div>`;
			}else if(selQuestLen == index){
				operationBtn = `<div class="btnNextCon text-center">
									<button class="mybtn btnNext btnRip">next</button>
								</div>`;
			}else{
				operationBtn = `<div class="btnNextCon d-flex">
									<button class="mybtn btnPrev btnRip">Back</button>
									<button class="mybtn btnNext btnRip ml-auto">Next</button>
								</div>`;
			}
			var bgColor = ["bg1","bg2","bg3","bg4","bg5"]
			var ranBGColor = bgColor.sort(() => Math.random() - 0.5);
			var template = `<div class="questItem ${ranBGColor[index]}">
					<div class="row h-100 justify-content-center align-items-center">
						<div class="col-md-12">
							<div class="container">
					
							<h2 class="mb-3">${i['q']}</h2>
							<div class="row">
								${option}
							</div>
								${operationBtn}
							</div>
						</div>
					</div>
				</div>`;
			$('.theQuestion').prepend(template);
		});


		$(function(){


			$('.btnOption').click(function(){
				$(this).parent().find('.btnOption').removeClass('selected')
				$(this).addClass('selected');
				var getid = $(this).data('qid');
				var getval = $(this).data('val');
				var getltr = $(this).data('letter');
				var checkId = false;

				if (userAns.length > 0) {
					userAns.forEach(function(itm, idx){
						if(itm['qid'] == getid){
							checkId = true;
						}
					});
				}

				if (checkId) {
					objIndex = userAns.findIndex((obj => obj.qid == getid));
					userAns[objIndex].ans = getval;
					userAns[objIndex].let = getltr;
				}else{
					userAns.push({qid: getid, ans: getval, let: getltr})
				}

			});

			$('.theQuestion').slick({
			    accessibility: false,
			   	infinite: false,
			   	arrows: false,
			   	draggable:false
			});

			$('.btnNext').click(function(){
				$('.theQuestion').slick('slickNext');
			});
			
			$('.btnPrev').click(function(){
				$('.theQuestion').slick('slickPrev');
			});

			$('.btnDone').click(function(){
				questions.forEach(function(val, idx){
					userAns.forEach(function(v,i){
						if (v['qid'] == val['id']) {
							if (v['ans'] == val['a'] ) {
								checkAns.push({qid:v['qid'],q:val['q'], anslet: v['let'], ansval: v['ans'], verdict: 'correct'})
							}else{
								wrongAns.push({qid:v['qid'],q:val['q'], anslet: v['let'], ansval: v['ans'], verdict: 'wrong'})
							}
						}
					})
				});

				var getNoOfCheck = checkAns.length;

				$('#summary h2').text('You got a score of ' + getNoOfCheck + ' out of ' + numSelQuest);
				var sumContent = '';
				checkAns.forEach(function(val, index){
					sumContent += `<p>${val['q']}</p> <p>Your Answer : ${val['ansval']}</p>`;
				});	
				$('#summary .sumConent').html(sumContent);

				$('.theQuestion').slick('slickNext');
				
			});


		});







	</script>
</body>
</html>
